import{r as b,j as e}from"./iframe-Bt4UvEqW.js";import{u as S}from"./index.esm-ClsO7imu.js";import{V as v,c as y,d as N,a as E}from"./index-BlSK3dwA.js";import{B as C}from"./Button-40eEdaHr.js";import{u as V}from"./ButtonNavigation-DuwpFPZD.js";import"./Dropdown-D_2yar06.js";import"./FilePicker-D62rdBOg.js";import{I as g}from"./Input-Bygz4nLz.js";import"./Like-DXxARhTn.js";import"./Loader-ld3rHLDK.js";import"./index-DfYkHRSD.js";import"./PageLoader-HUM1dPua.js";import"./PageWrapper-Nh9y5AVa.js";import"./ConfirmDeleteModal-BXHaXOST.js";import{T as i}from"./Text-IhfjRFJQ.js";import"./TrackControlButton-DKEqXBy9.js";import"./UserAvatar-B3tKy1se.js";import{u as k}from"./useTranslation-D6XLV_9q.js";const q=async o=>v.promise((async()=>{const s=await y.get("/users",{params:{email:o.email}});if(!s.data||s.data.length===0)throw new Error("Пользователь с таким email не найден");const r=s.data[0];if(!N.compareSync(o.password,r.password))throw new Error("Неверный пароль");const l=E.getState().setAuthData;return l(r),r})(),{loading:"Вход в систему...",success:"Вы успешно вошли",error:s=>s instanceof Error?s.message:"Ошибка при входе в систему"}).catch(()=>null),Q=({onSuccess:o})=>{const{t:s}=k("loginForm"),r=V(),{register:m,handleSubmit:l,formState:{errors:a,isSubmitting:n,isSubmitted:d},trigger:p}=S({mode:"onSubmit"}),[c,x]=b.useState(""),[u,w]=b.useState(""),f=t=>{x(t),d&&p("email")},h=t=>{w(t),d&&p("password")},j=async()=>{await q({email:c,password:u})&&(o(),r("/main"))};return e.jsxs("form",{onSubmit:t=>{l(j)(t)},autoComplete:"off",noValidate:!0,children:[e.jsx(i,{title:s("title")}),e.jsxs("div",{className:"mb-6",children:[e.jsx(i,{className:"block mb-2 font-semibold text-black text-lg",text:s("email.label")}),e.jsx(g,{id:"email",type:"email",...m("email",{required:s("email.required"),pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:s("email.invalid")}}),value:c,onChangeHandler:f,disabled:n,placeholder:s("email.placeholder"),className:a.email?"border-red-500":"border-gray-300"}),a.email&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.email.message})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx(i,{className:"block mb-2 font-semibold text-black text-lg",text:s("password.label")}),e.jsx(g,{id:"password",type:"password",...m("password",{required:s("password.required"),minLength:{value:6,message:s("password.minLength")}}),value:u,onChangeHandler:h,disabled:n,placeholder:s("password.placeholder"),className:a.password?"border-red-500":"border-gray-300"}),a.password&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.password.message})]}),e.jsx(C,{type:"submit",disabled:n,className:"w-full",children:e.jsx(i,{text:s("submit")})})]})};export{Q as L};
