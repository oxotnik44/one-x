import{r as a,u as $,j as i}from"./iframe-Bt4UvEqW.js";import{u as H}from"./useTranslation-D6XLV_9q.js";const I=({accept:l,onChange:s,placeholder:g,previewUrl:w=null,title:j,className:E,style:F,active:L=!1,directory:C=!1})=>{const c=$(t=>t.theme),k=a.useRef(null),{t:P}=H("filePicker"),[R,v]=a.useState(!1),[T,f]=a.useState(!1),N=a.useCallback(()=>{k.current?.click()},[]),A=a.useCallback(t=>{const o=t.target.files;if(!o||o.length===0){s(null);return}const n=o[0]?.webkitRelativePath?.split("/")[0]??"";s(o,n)},[s]),O=t=>l?l.split(",").map(r=>r.trim()).some(r=>r.startsWith(".")?t.name.toLowerCase().endsWith(r.toLowerCase()):t.type===r):!0,S=a.useCallback(async t=>{t.preventDefault(),f(!1);const o=t.dataTransfer.items,r=[];let n=null;const x=async(e,u="")=>{if(e.isFile)await new Promise(m=>{e.file(d=>{r.push(d),m()})});else if(e.isDirectory){n||(n=e.name);const m=e.createReader(),d=()=>new Promise(p=>m.readEntries(p));let h=[];do{h=await d();for(const p of h)await x(p,`${u}${e.name}/`)}while(h.length>0)}},b=Array.from(o).map(e=>e.webkitGetAsEntry?.()).filter(e=>!!e);if(b.length===0){s(null);return}for(const e of b)await x(e);const D=r.filter(O);if(D.length>0){const e=new DataTransfer;D.forEach(u=>e.items.add(u)),s(e.files,n??"")}else s(null)},[s,l]),y=R||L||T;return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:`flex-shrink-0 flex justify-center items-center rounded-md border-2 border-dashed cursor-pointer max-w-32 max-h-32 mx-auto transition-colors ${E||""}`,style:{borderColor:c["--primary-color"]||"#880015",color:y?"#fff":c["--primary-color"]||"#880015",width:"6rem",height:"6rem",backgroundColor:y?c["--primary-color"]:"transparent",...F},title:j??P("title"),onClick:N,onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),onDragOver:t=>{t.preventDefault(),f(!0)},onDragLeave:()=>f(!1),onDrop:S,children:w?i.jsx("img",{src:w,alt:"preview",className:"object-cover rounded-md w-full h-full"}):g}),i.jsx("input",{type:"file",ref:k,accept:l,onChange:A,className:"hidden",...C?{webkitdirectory:"true"}:{}})]})},G=a.memo(I);export{G as F};
