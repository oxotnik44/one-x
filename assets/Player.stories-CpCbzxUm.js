import{r as i,u as M,j as t,R as V}from"./iframe-C0kfoYRU.js";import{d as a,b as D,f as y,c as S,l as L,P as z}from"./AutoHideScroll-Bn4kiatZ.js";import{B,a as F,b as $}from"./Button-BG29j6-m.js";import{M as E}from"./ButtonNavigation-AGHQnJJF.js";import"./Dropdown-B0nLrr0u.js";import"./FilePicker-BOxeBJkN.js";import"./Input-Syt8WR94.js";import{L as R}from"./Like-CU83MUjH.js";import"./Loader-BA1QRYy5.js";import"./index-CCh5LiNu.js";import"./PageLoader-CjR7aYj7.js";import"./PageWrapper-CUwEEPPt.js";import{T as C}from"./Text-Cv_jbED3.js";import{T as N}from"./TrackControlButton-Cp9njBny.js";import"./UserAvatar-D3VV5S8d.js";import{F as U,a as A}from"./index-DJP2UdXn.js";import{u as w}from"./useTranslation-DTQxaVaH.js";import"./Sidebar-BzTTIffb.js";import{u as O,p as _,s as q}from"./sidebarStore-DngkkDiT.js";import"./Modal-ot01iIn6.js";import"./classNames-CSVCBH4b.js";import"./iconBase-BzJrSpo7.js";import"./index-BXuEUrgA.js";const G=()=>{const n=a(e=>e.progress),m=a(e=>e.currentTime),u=a(e=>e.duration),r=a(e=>e.volume),p=a(e=>e.isMuted),o=a(e=>e.audio),x=a(e=>e.currentTrack),g=a(e=>e.setProgress),k=a(e=>e.setVolume),d=a(e=>e.setIsMuted),h=a(e=>e.setCurrentTrack),c=D(e=>e.tracks)??[],v=i.useCallback(e=>{if(!o)return;const f=Number(e.target.value);o.currentTime=f/100*u,g(f)},[o,u,g]),b=i.useCallback(e=>{const f=Number(e.target.value);k(f),d(f===0)},[k,d]),s=i.useCallback(()=>{d(!p)},[p,d]),l=i.useCallback(()=>{if(!o)return;const e=c.findIndex(f=>f.id===x?.id);o.currentTime>5?(o.currentTime=0,g(0)):e>0?h(c[e-1]):(o.currentTime=0,g(0))},[o,x,c,g,h]),j=i.useCallback(()=>{if(!o)return;const e=c.findIndex(f=>f.id===x?.id);e!==-1&&e<c.length-1&&h(c[e+1])},[o,x,c,h]);return i.useMemo(()=>({progress:n,currentTime:m,duration:u,formattedCurrentTime:y(m),formattedDuration:y(u),volume:r,isMuted:p,onSeek:v,onVolumeChange:b,toggleMute:s,onPrev:l,onNext:j}),[n,m,u,r,p,v,b,s,l,j])},P=i.memo(()=>{const{t:n}=w("volumeControl"),m=a(s=>s.volume),u=a(s=>s.isMuted),r=a(s=>s.audio),p=a(s=>s.setVolume),o=a(s=>s.setIsMuted),x=M(s=>s.theme),[g,k]=i.useState(!1),d=i.useRef(null),h=i.useCallback(()=>{const s=!u;o(s),r&&(r.volume=s?0:m)},[u,o,r,m]),c=i.useCallback(s=>{const l=Number(s.target.value);p(l),o(l===0),r&&(r.volume=l)},[p,o,r]),v=i.useCallback(()=>{d.current&&clearTimeout(d.current),k(!0)},[]),b=i.useCallback(()=>{d.current=setTimeout(()=>k(!1),500)},[]);return t.jsxs("div",{className:"flex-none ml-auto relative flex items-center space-x-2",onMouseEnter:v,onMouseLeave:b,children:[t.jsx(B,{size:F.M,square:!0,onClick:h,"aria-label":n(u?"unmute":"mute"),children:u||m===0?t.jsx(U,{className:"h-5 w-5"}):t.jsx(A,{className:"h-5 w-5"})}),t.jsx("input",{type:"range",min:0,max:1,step:.01,value:m,onChange:c,className:`absolute -top-16 left-4 -translate-x-1/2 w-24 h-6
                    rotate-[-90deg] origin-center cursor-pointer rounded
                    transition-opacity duration-300
                    ${g?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}
                `,style:{accentColor:x["--button-color"],border:`1px solid ${x["--bg-container"]}`},"aria-label":n("volumeControl")})]})});P.displayName="VolumeControl";const I=V.memo(()=>{const{t:n}=w("player"),m=M(l=>l.theme),u=O(l=>l.isCollapsed),r=a(l=>l.currentTrack),p=S(l=>l.authData),{progress:o,onSeek:x,onPrev:g,onNext:k,formattedCurrentTime:d,formattedDuration:h}=G(),c=m["--button-color"]||"#ec4899",v=u?"calc(var(--sidebar-width-collapsed) + 1.5rem)":"calc(var(--sidebar-width) + 1.5rem)",b=r?!!p?.likedTracks?.includes(r.id):!1,s=i.useCallback(()=>{r&&L(r.id)},[r]);return t.jsxs("div",{className:"fixed z-40 flex flex-col rounded-3xl transition-all duration-300 ease-in-out px-6",style:{...q,..._,backgroundColor:m["--bg-container"],height:"var(--player-height)",left:v,right:"1.5rem",bottom:"1.5rem"},children:[t.jsx("input",{type:"range",min:0,max:100,value:Number.isFinite(o)?o:0,onChange:x,className:"w-full h-1 rounded-t-3xl appearance-none bg-gray-700 range-hover-thumb",style:{backgroundColor:"#4b5563",backgroundImage:`linear-gradient(
      to right,
      ${c},
      ${c}
    )`,backgroundSize:`${Math.max(o)}% 100%`,backgroundRepeat:"no-repeat",accentColor:c},"aria-label":n("seek")}),t.jsxs("div",{className:"flex items-center flex-1 mt-2 relative",children:[t.jsx("div",{className:"flex items-center space-x-4 w-[192px] flex-shrink-0",children:r&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"w-12 h-12 rounded-lg overflow-hidden flex-shrink-0",children:t.jsx("img",{src:r.cover||"/assets/default-cover.png",alt:r.title||n("coverAlt"),className:"w-full h-full object-cover"})}),t.jsxs("div",{className:"flex flex-col justify-center overflow-hidden min-w-0",children:[t.jsx(C,{className:"text-sm font-semibold truncate",children:r.title}),t.jsx(C,{className:"text-xs text-gray-400 truncate",children:r.groupName??n("noAuthor")})]})]})}),t.jsxs("div",{className:"absolute left-1/2 transform -translate-x-1/2 flex items-center space-x-2",children:[t.jsx(R,{liked:b,onToggle:s,className:r?"":"hidden"}),t.jsx(N,{direction:"prev",onClick:g,ariaLabel:n("prev")}),t.jsx(z,{theme:$.OUTLINE,trackForPlay:r}),t.jsx(N,{direction:"next",onClick:k,ariaLabel:n("next")})]}),t.jsxs("div",{className:"flex items-center ml-auto space-x-2",children:[t.jsx(P,{}),t.jsx(C,{text:`${d} / ${h}`,size:"small",className:"text-white"})]})]})]})});I.displayName="Player";const H={id:"track-1",title:"Тестовый трек",groupName:"Test Group",cover:"/assets/Logo.webp",duration:210,groupId:"group-1",audioUrl:"/audio/test.mp3",createdAt:new Date().toISOString()},J={id:"user-1",username:"TestUser",password:"secret",avatar:"/assets/avatar.png",createdAt:new Date().toISOString(),likedTracks:["track-1"]},K=n=>(a.setState({currentTrack:H,progress:37,currentTime:77,isPlaying:!0,duration:210,volume:.8,isMuted:!1,audio:null,setCurrentTrack:()=>{},setProgress:()=>{},setIsPlaying:()=>{},setDuration:()=>{},setVolume:()=>{},setIsMuted:()=>{},togglePlay:()=>{}}),S.setState({authData:J,setAuthData:()=>{},logout:()=>{},toggleLikeTrack:()=>{}}),t.jsx(n,{})),ke={title:"Features/Player",component:I,decorators:[K,n=>t.jsx(E,{children:t.jsx("div",{style:{position:"relative",minHeight:300},children:t.jsx(n,{})})})]},T={};T.parameters={...T.parameters,docs:{...T.parameters?.docs,source:{originalSource:"{}",...T.parameters?.docs?.source}}};const ve=["Default"];export{T as Default,ve as __namedExportsOrder,ke as default};
