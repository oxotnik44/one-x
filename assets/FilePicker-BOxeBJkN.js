import{r as i,u as H,j as l}from"./iframe-C0kfoYRU.js";import{u as I}from"./useTranslation-DTQxaVaH.js";const M=({accept:a,onChange:s,placeholder:g,previewUrl:h=null,title:y,className:P="",style:j,active:F=!1,directory:C=!1})=>{const n=H(e=>e.theme),{t:E}=I("filePicker"),p=i.useRef(null),[R,w]=i.useState(!1),[T,c]=i.useState(!1),k=R||T||F,L=i.useCallback(()=>{p.current?.click()},[]),N=i.useCallback(e=>{const r=e.target.files;if(!r?.length)return s(null);const o=r[0].webkitRelativePath?.split("/")[0]??"";s(r,o)},[s]),A=e=>a?a.split(",").some(r=>r.trim().startsWith(".")?e.name.toLowerCase().endsWith(r.trim().toLowerCase()):e.type===r.trim()):!0,O=i.useCallback(async e=>{e.preventDefault(),c(!1);const r=e.dataTransfer.items,f=Array.from(r).map(t=>t.webkitGetAsEntry?.()).filter(t=>!!t),o=[];let v=null;const x=async t=>{if(t.isFile){const m=await new Promise(u=>t.file(u));o.push(m)}else if(t.isDirectory){v??=t.name;const m=t.createReader(),u=()=>new Promise(S=>m.readEntries(S));let d=[];do d=await u(),await Promise.all(d.map(x));while(d.length)}};if(!f.length)return s(null);await Promise.all(f.map(x));const b=o.filter(A);if(!b.length)return s(null);const D=new DataTransfer;b.forEach(t=>D.items.add(t)),s(D.files,v??"")},[a,s]);return l.jsxs(l.Fragment,{children:[l.jsx("div",{title:y??E("title"),onClick:L,onMouseEnter:()=>w(!0),onMouseLeave:()=>w(!1),onDragOver:e=>{e.preventDefault(),c(!0)},onDragLeave:()=>c(!1),onDrop:O,className:`flex-shrink-0 flex justify-center items-center mx-auto max-w-32 max-h-32 rounded-md border-2 border-dashed cursor-pointer transition-colors ${P}`,style:{width:"6rem",height:"6rem",borderColor:n["--primary-color"],color:k?"#fff":n["--primary-color"],backgroundColor:k?n["--primary-color"]:"transparent",...j},children:h?l.jsx("img",{src:h,alt:"preview",className:"object-cover w-full h-full rounded-md"}):g}),l.jsx("input",{ref:p,type:"file",accept:a,onChange:N,className:"hidden",...C?{webkitdirectory:"true"}:{}})]})},W=i.memo(M);W.displayName="FilePicker";export{W as F};
