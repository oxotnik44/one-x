import{r as k,j as i}from"./iframe-U8ya4lKj.js";import{T}from"./TrackItem-BO_8qinM.js";import{b as x,a as f}from"./api-BNB6Hzxt.js";import"./index-DSF9hKFK.js";import{u as g}from"./GroupCover-BGBq_pSL.js";import{u as m}from"./useTrackStore-OiNvfdpV.js";import{B as h,a as v,b as U}from"./Button-DE9W436l.js";import{u as j}from"./ButtonNavigation-COrRjsTF.js";import"./Dropdown-DwKt7Qhu.js";import"./FilePicker-CbYA0TGi.js";import"./Input-DaFUx77P.js";import"./Like-B3pHqG2f.js";import"./Loader-DiHYOjMw.js";import"./index-C84dbosL.js";import"./PageLoader-DRYwdG-o.js";import"./PageWrapper-CGXxUwgW.js";import"./PlayButton-DHaq6iyc.js";import"./Text-DVKAWUAM.js";import"./TrackControlButton-9SyhFgiT.js";import"./UserAvatar-QfRyJ_rf.js";import{u as y}from"./useTranslation-CSTQQmYg.js";async function S(c,a,t,r){try{const[s,p]=await Promise.all([x.get("/tracks",{params:{groupId:c,albumId:t&&r?t:void 0}}),t&&r?f.get(`/album-tracks/${encodeURIComponent(a)}/${encodeURIComponent(r)}`):f.get(`/tracks/${encodeURIComponent(a)}`)]),d=s.data;if(!Array.isArray(d))return m.getState().setTracks([]),[];let e=[];if(t&&r){const o=p.data,l=o.coverUrl??"";e=o.tracks.map(n=>({trackName:n.trackName,audioUrl:n.audioUrl,coverUrl:l}))}else e=p.data;const u=d.map(o=>{const l=e.find(n=>n.trackName===o.id||n.trackName===o.title);return{...o,cover:l?.coverUrl??"",audioUrl:l?.audioUrl??"",groupName:a}}).filter(o=>t&&r?o.albumId===t:!o.albumId||o.albumId==="");return m.getState().setTracks(u),u}catch(s){return console.error("Ошибка при загрузке треков с медиа",s),m.getState().setTracks([]),[]}}const M=({albumId:c,albumName:a})=>{const{t}=y("listTrack"),r=g(e=>e.currentGroup),s=m(e=>e.tracks),p=j();if(k.useEffect(()=>{r&&(m.getState().setTracks([]),S(r.id,r.name,c,a))},[r,c,a]),!r)return i.jsx("div",{children:t("noGroup")});const d=()=>{p("/my_group/add_track")};return i.jsxs("div",{className:"flex flex-col flex-grow h-full min-h-0",children:[i.jsx("div",{className:"overflow-y-auto flex-grow pr-2 space-y-4 min-h-0",children:s.length>0?s.map(e=>i.jsx(T,{track:e,groupName:r.name},e.id)):i.jsx("div",{children:t("noTracks")})}),!c&&i.jsx(h,{theme:U.OUTLINE,size:v.L,className:"self-center mt-4",onClick:d,children:t("addTrack")})]})};export{M as L};
