import{r as n,u as S,j as e,R as I}from"./iframe-U8ya4lKj.js";import{u as o,f as N,l as L}from"./usePlayerStore-DnPMUqle.js";import{F as z,a as B}from"./index-Crfi9Vkz.js";import{B as $,a as E,b as F}from"./Button-DE9W436l.js";import{M as R}from"./ButtonNavigation-COrRjsTF.js";import"./Dropdown-DwKt7Qhu.js";import"./FilePicker-CbYA0TGi.js";import"./GroupCover-BGBq_pSL.js";import"./Input-DaFUx77P.js";import{L as U}from"./Like-B3pHqG2f.js";import"./Loader-DiHYOjMw.js";import"./index-C84dbosL.js";import"./PageLoader-DRYwdG-o.js";import"./PageWrapper-CGXxUwgW.js";import{P as A}from"./PlayButton-DHaq6iyc.js";import{T as j}from"./Text-DVKAWUAM.js";import{T as M}from"./TrackControlButton-9SyhFgiT.js";import"./UserAvatar-QfRyJ_rf.js";import{u as P}from"./useTranslation-CSTQQmYg.js";import{u as w}from"./index-DSF9hKFK.js";import"./api-BNB6Hzxt.js";import"./Sidebar-qUSoMN9k.js";import{u as O,p as _,s as q}from"./sidebarStore-CdVUyuQU.js";import"./iconBase--zlYJr49.js";import"./classNames-DZENv8ZT.js";import"./clsx-B-dksMZM.js";import"./index-B1nOipFJ.js";import"./index-B2TlSA0P.js";const G=({onPrevTrack:a,onNextTrack:c}={})=>{const p=o(t=>t.progress),s=o(t=>t.currentTime),u=o(t=>t.duration),i=o(t=>t.isPlaying),v=o(t=>t.volume),g=o(t=>t.isMuted),l=o(t=>t.audio),m=o(t=>t.setProgress),b=o(t=>t.setVolume),x=o(t=>t.setIsMuted),f=o(t=>t.togglePlay),k=n.useCallback(t=>{if(!l)return;const C=Number(t.target.value);l.currentTime=C/100*u,m(C)},[l,u,m]),r=n.useCallback(t=>{const C=Number(t.target.value);b(C),x(C===0)},[b,x]),h=n.useCallback(()=>{x(!g)},[g,x]),d=n.useCallback(()=>{l&&l.currentTime>5?(l.currentTime=0,m(0)):a?.()},[l,a,m]),T=n.useCallback(()=>{c?.()},[c]);return n.useMemo(()=>({progress:p,currentTime:s,duration:u,formattedCurrentTime:N(s),formattedDuration:N(u),isPlaying:i,volume:v,isMuted:g,togglePlay:f,onSeek:k,onVolumeChange:r,toggleMute:h,onPrev:d,onNext:T}),[p,s,u,i,v,g,f,k,r,h,d,T])},V=n.memo(()=>{const{t:a}=P("volumeControl"),c=o(r=>r.volume),p=o(r=>r.isMuted),s=o(r=>r.audio),u=o(r=>r.setVolume),i=o(r=>r.setIsMuted),v=S(r=>r.theme),[g,l]=n.useState(!1),m=n.useRef(null),b=n.useCallback(()=>{const r=!p;i(r),s&&(s.volume=r?0:c)},[p,i,s,c]),x=n.useCallback(r=>{const h=Number(r.target.value);u(h),i(h===0),s&&(s.volume=h)},[u,i,s]),f=n.useCallback(()=>{m.current&&clearTimeout(m.current),l(!0)},[]),k=n.useCallback(()=>{m.current=setTimeout(()=>l(!1),500)},[]);return e.jsxs("div",{className:"flex-none ml-auto relative flex items-center space-x-2",onMouseEnter:f,onMouseLeave:k,children:[e.jsx($,{size:E.M,square:!0,onClick:b,"aria-label":a(p?"unmute":"mute"),children:p||c===0?e.jsx(z,{className:"h-5 w-5"}):e.jsx(B,{className:"h-5 w-5"})}),e.jsx("input",{type:"range",min:0,max:1,step:.01,value:c,onChange:x,className:`absolute -top-16 left-4 -translate-x-1/2 w-24 h-6
                    rotate-[-90deg] origin-center cursor-pointer rounded
                    transition-opacity duration-300
                    ${g?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}
                `,style:{accentColor:v["--button-color"],border:`1px solid ${v["--bg-container"]}`},"aria-label":a("volumeControl")})]})});V.displayName="VolumeControl";const D=I.memo(()=>{const{t:a}=P("player"),c=S(d=>d.theme),p=O(d=>d.isCollapsed),s=o(d=>d.currentTrack),u=w(d=>d.authData),{progress:i,isPlaying:v,togglePlay:g,onSeek:l,onPrev:m,formattedCurrentTime:b,formattedDuration:x}=G({}),f=c["--button-color"]||"#ec4899",k=p?"calc(var(--sidebar-width-collapsed) + 1.5rem)":"calc(var(--sidebar-width) + 1.5rem)",r=s?!!u?.likedTracks?.includes(s.id):!1,h=n.useCallback(()=>{s&&L(s.id)},[s]);return e.jsxs("div",{className:"fixed z-40 flex flex-col rounded-3xl transition-all duration-300 ease-in-out px-6",style:{...q,..._,backgroundColor:c["--bg-container"],height:"var(--player-height)",left:k,right:"1.5rem",bottom:"1.5rem"},children:[e.jsx("input",{type:"range",min:0,max:100,value:Number.isFinite(i)?i:0,onChange:l,className:"w-full h-1 rounded-t-3xl appearance-none bg-gray-700 range-hover-thumb",style:{backgroundColor:"#4b5563",backgroundImage:`linear-gradient(
      to right,
      ${f},
      ${f}
    )`,backgroundSize:`${Math.max(i)}% 100%`,backgroundRepeat:"no-repeat",accentColor:f},"aria-label":a("seek")}),e.jsxs("div",{className:"flex items-center flex-1 mt-2 relative",children:[e.jsx("div",{className:"w-[192px] flex-shrink-0 flex items-center",children:s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-12 h-12 rounded-lg overflow-hidden mr-4",children:e.jsx("img",{src:s.cover||"/assets/default-cover.png",alt:s.title||a("coverAlt"),className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex flex-col justify-center",children:[e.jsx(j,{className:"text-sm font-semibold truncate",children:s.title}),e.jsx(j,{className:"text-xs text-gray-400 truncate",children:s.groupName??a("noAuthor")})]})]})}),e.jsxs("div",{className:"absolute left-1/2 transform -translate-x-1/2 flex items-center space-x-2",children:[s&&e.jsx(U,{liked:r,onToggle:h}),e.jsx(M,{direction:"prev",onClick:m,ariaLabel:a("prev")}),e.jsx(A,{isPlaying:v,isCurrent:!0,onClick:g,theme:F.OUTLINE}),e.jsx(M,{direction:"next",ariaLabel:a("next")})]}),e.jsxs("div",{className:"flex items-center ml-auto space-x-2",children:[e.jsx(V,{}),e.jsx(j,{text:`${b} / ${x}`,size:"small",className:"text-white"})]})]})]})});D.displayName="Player";const H={id:"track-1",title:"Тестовый трек",groupName:"Test Group",cover:"/assets/Logo.webp",duration:210,groupId:"group-1",audioUrl:"/audio/test.mp3",createdAt:new Date().toISOString()},J={id:"user-1",username:"TestUser",password:"secret",avatar:"/assets/avatar.png",createdAt:new Date().toISOString(),likedTracks:["track-1"]},K=a=>(o.setState({currentTrack:H,progress:37,currentTime:77,isPlaying:!0,duration:210,volume:.8,isMuted:!1,audio:null,setCurrentTrack:()=>{},setProgress:()=>{},setCurrentTime:()=>{},setIsPlaying:()=>{},setDuration:()=>{},setVolume:()=>{},setIsMuted:()=>{},togglePlay:()=>{},resetPlayer:()=>{}}),w.setState({authData:J,setAuthData:()=>{},logout:()=>{},toggleLikeTrack:()=>{}}),e.jsx(a,{})),je={title:"Features/Player",component:D,decorators:[K,a=>e.jsx(R,{children:e.jsx("div",{style:{position:"relative",minHeight:300},children:e.jsx(a,{})})})]},y={};y.parameters={...y.parameters,docs:{...y.parameters?.docs,source:{originalSource:"{}",...y.parameters?.docs?.source}}};const Te=["Default"];export{y as Default,Te as __namedExportsOrder,je as default};
