import{r as d,j as t}from"./iframe-C0kfoYRU.js";import{b as f,B as b,a as y}from"./Button-BG29j6-m.js";import{u as j}from"./ButtonNavigation-AGHQnJJF.js";import"./Dropdown-B0nLrr0u.js";import"./FilePicker-BOxeBJkN.js";import{u as p,g as A,e as k,V as h,a as N,c as C,P as w}from"./AutoHideScroll-Bn4kiatZ.js";import"./Input-Syt8WR94.js";import{L}from"./Like-CU83MUjH.js";import"./Loader-BA1QRYy5.js";import"./index-CCh5LiNu.js";import"./PageLoader-CjR7aYj7.js";import"./PageWrapper-CUwEEPPt.js";import{T as S}from"./Text-Cv_jbED3.js";import"./TrackControlButton-Cp9njBny.js";import"./UserAvatar-D3VV5S8d.js";import{S as g}from"./Skeleton-B5AyTU65.js";import{u as T}from"./useTranslation-DTQxaVaH.js";import{l as E}from"./likeAlbum-gMHzl6hR.js";async function P(a,r){try{const s=p.getState().setAlbums,[i,n]=await Promise.all([A.get("/albums",{params:{groupId:a}}),k.get(`/albumCovers/${encodeURIComponent(r)}`)]),l=new Map;for(const e of n.data)l.set(e.albumTitle,e.coverUrl);const c=i.data.map(e=>({...e,cover:l.get(e.name)??e.cover??""}));s(c)}catch(s){h.error(s instanceof Error?s.message:"Ошибка при загрузке альбомов",{})}}function B(){const{t:a}=T("listAlbum"),r=N(o=>o.currentGroup),s=p(o=>o.albums),i=p(o=>o.setCurrentAlbum),n=C(o=>o.authData),l=j(),[c,e]=d.useState(!1);d.useEffect(()=>{r&&s.length===0&&(e(!0),P(r.id,r.name).catch(o=>{console.error(o),h.error(a("loadError"))}).finally(()=>e(!1)))},[r,s.length,a]);const m=d.useCallback(()=>{l("/my_group/add_album")},[l]),u=d.useCallback(o=>{const x=s.find(v=>v.id===o);x&&i(x),l(`/my_group/album/${encodeURIComponent(o)}`)},[s,l,i]);return{t:a,currentGroup:r,albums:s,authData:n,loading:c,onAddAlbumClick:m,onAlbumClick:u}}const X=()=>{const{t:a,currentGroup:r,albums:s,authData:i,loading:n,onAddAlbumClick:l,onAlbumClick:c}=B();return r?t.jsxs("div",{className:"flex flex-col",children:[n?t.jsx("div",{className:"grid grid-cols-2 gap-6",children:Array.from({length:2}).map((e,m)=>t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx(g,{className:"w-32 h-32 rounded-xl"}),t.jsx(g,{className:"h-4 w-24 mt-2 rounded"})]},m))}):s.length===0?t.jsx("div",{className:"text-center text-gray-500",children:a("noAlbums")}):t.jsx("div",{className:"grid grid-cols-2 gap-6 overflow-y-auto max-h-[318px] pr-2",children:s.map(e=>{const m=i?.likedAlbums?.includes(e.id)??!1;return t.jsxs("div",{onClick:()=>c(e.id),className:"group relative flex flex-col items-center focus:outline-none cursor-pointer",children:[t.jsxs("div",{className:"relative w-32 h-32 rounded-xl shadow-md overflow-hidden",children:[t.jsx("img",{src:e.cover||"/assets/default-cover.png",alt:e.name,className:"w-full h-full object-cover rounded-xl transition-opacity duration-200 ease-in-out"}),t.jsx("div",{className:"absolute inset-0 bg-black opacity-0 group-hover:opacity-60 rounded-xl transition-opacity"})]}),t.jsx(S,{text:e.name,size:"small",className:"mt-2 text-center break-words max-w-full"}),t.jsx("div",{className:"absolute mt-21 mr-18 opacity-0 group-hover:opacity-100 transition-opacity z-10",onClick:u=>{u.stopPropagation()},children:t.jsx(w,{theme:f.OUTLINE,albumForPlay:e,trackForPlay:null})}),t.jsx("div",{className:"absolute mt-23 ml-20 opacity-0 group-hover:opacity-100 transition-opacity z-10",onClick:u=>{u.stopPropagation()},children:t.jsx(L,{liked:m,onToggle:()=>E(e.id)})})]},e.id)})}),t.jsx(b,{theme:f.OUTLINE,size:y.L,className:"self-center mt-4",onClick:l,children:a("addAlbum")})]}):t.jsx("div",{className:"text-center text-gray-500",children:a("noGroup")})};export{X as L};
