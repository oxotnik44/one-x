import{r as d,j as t}from"./iframe-Bt4UvEqW.js";import{b as x,B as v,a as y}from"./Button-40eEdaHr.js";import{u as j}from"./ButtonNavigation-DuwpFPZD.js";import"./Dropdown-D_2yar06.js";import"./FilePicker-D62rdBOg.js";import{c as A,b as k,V as g,u as N,a as C}from"./index-BlSK3dwA.js";import"./Input-Bygz4nLz.js";import{L as w}from"./Like-DXxARhTn.js";import"./Loader-ld3rHLDK.js";import"./index-DfYkHRSD.js";import"./PageLoader-HUM1dPua.js";import"./PageWrapper-Nh9y5AVa.js";import{u as p,P as L}from"./ConfirmDeleteModal-BXHaXOST.js";import{T as S}from"./Text-IhfjRFJQ.js";import"./TrackControlButton-DKEqXBy9.js";import"./UserAvatar-B3tKy1se.js";import{S as h}from"./Skeleton-B9MDZpNi.js";import{l as E}from"./likeAlbum-DRyx3arP.js";import{u as P}from"./useTranslation-D6XLV_9q.js";async function T(r,a){try{const s=p.getState().setAlbums,[i,n]=await Promise.all([A.get("/albums",{params:{groupId:r}}),k.get(`/albumCovers/${encodeURIComponent(a)}`)]),l=new Map;for(const e of n.data)l.set(e.albumTitle,e.coverUrl);const c=i.data.map(e=>({...e,cover:l.get(e.name)??e.cover??""}));s(c)}catch(s){g.error(s instanceof Error?s.message:"Ошибка при загрузке альбомов",{})}}function B(){const{t:r}=P("listAlbum"),a=N(o=>o.currentGroup),s=p(o=>o.albums),i=p(o=>o.setCurrentAlbum),n=C(o=>o.authData),l=j(),[c,e]=d.useState(!1);d.useEffect(()=>{a&&s.length===0&&(e(!0),T(a.id,a.name).catch(o=>{console.error(o),g.error(r("loadError"))}).finally(()=>e(!1)))},[a,s.length,r]);const m=d.useCallback(()=>{l("/my_group/add_album")},[l]),u=d.useCallback(o=>{const f=s.find(b=>b.id===o);f&&i(f),l(`/my_group/album/${encodeURIComponent(o)}`)},[s,l,i]);return{t:r,currentGroup:a,albums:s,authData:n,loading:c,onAddAlbumClick:m,onAlbumClick:u}}const Y=()=>{const{t:r,currentGroup:a,albums:s,authData:i,loading:n,onAddAlbumClick:l,onAlbumClick:c}=B();return a?t.jsxs("div",{className:"flex flex-col",children:[n?t.jsx("div",{className:"grid grid-cols-2 gap-6",children:Array.from({length:2}).map((e,m)=>t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx(h,{className:"w-32 h-32 rounded-xl"}),t.jsx(h,{className:"h-4 w-24 mt-2 rounded"})]},m))}):s.length===0?t.jsx("div",{className:"text-center text-gray-500",children:r("noAlbums")}):t.jsx("div",{className:"grid grid-cols-2 gap-6 overflow-y-auto max-h-[318px] pr-2",children:s.map(e=>{const m=i?.likedAlbums?.includes(e.id)??!1;return t.jsxs("div",{onClick:()=>c(e.id),className:"group relative flex flex-col items-center focus:outline-none cursor-pointer",children:[t.jsxs("div",{className:"relative w-32 h-32 rounded-xl shadow-md overflow-hidden",children:[t.jsx("img",{src:e.cover||"/assets/default-cover.png",alt:e.name,className:"w-full h-full object-cover rounded-xl transition-opacity duration-200 ease-in-out"}),t.jsx("div",{className:"absolute inset-0 bg-black opacity-0 group-hover:opacity-60 rounded-xl transition-opacity"})]}),t.jsx(S,{text:e.name,size:"small",className:"mt-2 text-center break-words max-w-full"}),t.jsx("div",{className:"absolute mt-21 mr-18 opacity-0 group-hover:opacity-100 transition-opacity z-10",onClick:u=>{u.stopPropagation()},children:t.jsx(L,{theme:x.OUTLINE,albumForPlay:e,trackForPlay:null})}),t.jsx("div",{className:"absolute mt-23 ml-20 opacity-0 group-hover:opacity-100 transition-opacity z-10",onClick:u=>{u.stopPropagation(),E(e.id)},children:t.jsx(w,{liked:m})})]},e.id)})}),t.jsx(v,{theme:x.OUTLINE,size:y.L,className:"self-center mt-4",onClick:l,children:r("addAlbum")})]}):t.jsx("div",{className:"text-center text-gray-500",children:r("noGroup")})};export{Y as L};
