import{r as d,j as o}from"./iframe-U8ya4lKj.js";import{b as f,a as x,V as b}from"./api-BNB6Hzxt.js";import"./index-DSF9hKFK.js";import{u as h}from"./GroupCover-BGBq_pSL.js";import{u as i}from"./useAlbumStore-2sgAmzBL.js";import{B as v,a as g,b as A}from"./Button-DE9W436l.js";import{u as j}from"./ButtonNavigation-COrRjsTF.js";import"./Dropdown-DwKt7Qhu.js";import"./FilePicker-CbYA0TGi.js";import"./Input-DaFUx77P.js";import"./Like-B3pHqG2f.js";import"./Loader-DiHYOjMw.js";import"./index-C84dbosL.js";import"./PageLoader-DRYwdG-o.js";import"./PageWrapper-CGXxUwgW.js";import"./PlayButton-DHaq6iyc.js";import{T as C}from"./Text-DVKAWUAM.js";import"./TrackControlButton-9SyhFgiT.js";import"./UserAvatar-QfRyJ_rf.js";import{u as y}from"./useTranslation-CSTQQmYg.js";async function N(r,s){try{const e=i.getState().setAlbums,[m,a]=await Promise.all([f.get("/albums",{params:{groupId:r}}),x.get(`/albumCovers/${encodeURIComponent(s)}`)]),n=new Map;for(const t of a.data)n.set(t.albumTitle,t.coverUrl);const c=m.data.map(t=>({...t,cover:n.get(t.name)??t.cover??""}));e(c)}catch(e){b.error(e instanceof Error?e.message:"Ошибка при загрузке альбомов",{})}}const q=()=>{const{t:r}=y("listAlbum"),s=h(t=>t.currentGroup),e=i(t=>t.albums),m=i(t=>t.setCurrentAlbum),a=j();d.useEffect(()=>{s&&e.length===0&&N(s.id,s.name).catch(console.error)},[s,e.length]);const n=()=>{a("/my_group/add_album")},c=t=>{const l=e.find(p=>p.id===t);l&&m(l);const u=encodeURIComponent(t);a(`/my_group/album/${u}`)};return s?o.jsxs("div",{className:"flex flex-col",children:[e.length===0?o.jsx("div",{className:"text-center text-gray-500",children:r("noAlbums")}):o.jsx("div",{className:"grid grid-cols-2 gap-6 overflow-y-auto max-h-[318px] pr-2",children:e.map(t=>o.jsxs("button",{type:"button",onClick:()=>c(t.id),className:"flex flex-col items-center focus:outline-none transition-opacity duration-200 hover:opacity-70 cursor-pointer",children:[o.jsx("img",{src:t.cover||"/assets/default-cover.png",alt:t.name,className:"w-32 h-32 object-cover rounded-xl shadow-md"}),o.jsx(C,{text:t.name,size:"small",className:"mt-2 text-center break-words max-w-full"})]},t.id))}),o.jsx(v,{theme:A.OUTLINE,size:g.L,className:"self-center mt-4",onClick:n,children:r("addAlbum")})]}):o.jsx("div",{children:r("noGroup")})};export{q as L};
